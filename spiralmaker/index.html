<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpiralMaker</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="main-layout">
            <div class="sidebar">
                <div class="header-section">
                    <a href="../index.html" class="back-button">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5"/>
                            <path d="M12 19l-7-7 7-7"/>
                        </svg>
                        Back to Tools
                    </a>
                    <h1>SpiralMaker</h1>
                </div>
                <div class="control-group">
                    <h3>Image Input</h3>
                    <div class="file-input-container">
                        <label class="file-input">
                            Choose Image
                            <input type="file" id="imageInput" accept="image/*">
                        </label>
                        <img id="imageThumbnail" class="image-thumbnail" alt="Image preview">
                    </div>
                    <div id="status" class="status" style="display: none;"></div>
                </div>

                <div class="control-group">
                    <h3>Canvas Size</h3>
                    <div class="input-row">
                        <label>Width:</label>
                        <input type="number" id="canvasWidthValue" min="10" max="2000" step="1" value="200">
                        <span class="unit-label">mm</span>
                    </div>
                    <div class="input-row">
                        <label>Height:</label>
                        <input type="number" id="canvasHeightValue" min="10" max="2000" step="1" value="200">
                        <span class="unit-label">mm</span>
                    </div>
                    <div class="input-row">
                        <label>Zoom:</label>
                        <input type="range" id="canvasZoom" min="0.1" max="3" step="0.1" value="1">
                        <input type="number" id="canvasZoomValue" min="0.1" max="3" step="0.1" value="1">
                        <span class="unit-label">×</span>
                    </div>
                </div>

                <div class="control-group">
                    <h3>Pen Settings</h3>
                    <div class="input-row">
                        <label>Pen Diameter:</label>
                        <input type="number" id="penDiameterValue" min="0.01" max="10" step="0.01" value="0.5">
                        <span class="unit-label">mm</span>
                    </div>
                </div>

                <div class="control-group">
                    <h3>G-code Settings</h3>
                    <div class="input-row">
                        <label>Feed Rate:</label>
                        <input type="number" id="feedRateValue" min="50" max="10000" step="10" value="1500">
                        <span class="unit-label">mm/min</span>
                    </div>
                    <div class="input-row">
                        <label>Pen Down Z:</label>
                        <input type="number" id="penDownZValue" min="-20" max="5" step="0.01" value="-1">
                        <span class="unit-label">mm</span>
                    </div>
                    <div class="input-row">
                        <label>Pen Up Z:</label>
                        <input type="number" id="penUpZValue" min="0" max="50" step="0.01" value="2">
                        <span class="unit-label">mm</span>
                    </div>
                </div>

                <div class="control-group">
                    <h3>Spiral Pattern</h3>
                    <div class="input-row">
                        <label>Spiral Type:</label>
                        <select id="spiralType" style="width: 90px;">
                            <option value="archimedean">Archimedean</option>
                            <option value="logarithmic">Logarithmic</option>
                        </select>
                    </div>
                    <div class="input-row">
                        <label>Spiral Count:</label>
                        <input type="number" id="spiralCountValue" min="1" max="10" step="1" value="3">
                        <span class="unit-label">spirals</span>
                    </div>
                    <div class="input-row">
                        <label>Turns:</label>
                        <input type="number" id="turnsValue" min="1" max="50" step="0.5" value="10">
                        <span class="unit-label">turns</span>
                    </div>
                    <div class="input-row">
                        <label>Spiral Spacing:</label>
                        <input type="number" id="spiralSpacingValue" min="0.1" max="10" step="0.1" value="2">
                        <span class="unit-label">mm</span>
                    </div>
                    <div class="input-row">
                        <label>Max Displacement:</label>
                        <input type="number" id="maxDisplacementValue" min="0" max="50" step="0.5" value="10">
                        <span class="unit-label">mm</span>
                    </div>
                    <div class="input-row">
                        <label>Displacement Power:</label>
                        <input type="number" id="displacementPowerValue" min="0.1" max="5" step="0.1" value="1.5">
                        <span class="unit-label">×</span>
                    </div>
                    <div class="input-row">
                        <label>Curve Type:</label>
                        <select id="curveType" style="width: 90px;">
                            <option value="inverted" selected>Inverted</option>
                            <option value="midtone">Mid-tone</option>
                            <option value="linear">Linear</option>
                            <option value="normal">Normal</option>
                        </select>
                    </div>
                    <div class="input-row">
                        <label>Mid-tone Center:</label>
                        <input type="number" id="midtoneCenterValue" min="0.1" max="0.9" step="0.05" value="0.5">
                        <span class="unit-label">level</span>
                    </div>
                    <div class="input-row">
                        <label>Curve Strength:</label>
                        <input type="number" id="curveStrengthValue" min="0.5" max="3" step="0.1" value="1.5">
                        <span class="unit-label">×</span>
                    </div>
                    <div class="input-row">
                        <label>Displacement Mode:</label>
                        <select id="displacementMode" style="width: 90px;">
                            <option value="surface3d" selected>3D Surface</option>
                            <option value="radial">Radial</option>
                            <option value="gradient">Gradient</option>
                            <option value="normal">Normal</option>
                            <option value="mixed">Mixed</option>
                        </select>
                    </div>
                    <div class="input-row">
                        <label>Viewing Angle:</label>
                        <input type="number" id="viewingAngleValue" min="0" max="89" step="1" value="45">
                        <span class="unit-label">°</span>
                    </div>
                    <div class="input-row">
                        <label>Light Direction:</label>
                        <input type="number" id="lightDirectionValue" min="0" max="360" step="1" value="315">
                        <span class="unit-label">°</span>
                    </div>
                    <div class="input-row">
                        <label>Surface Height:</label>
                        <input type="number" id="surfaceHeightValue" min="1" max="50" step="1" value="15">
                        <span class="unit-label">mm</span>
                    </div>
                    <div class="input-row">
                        <label>Min Displacement:</label>
                        <input type="number" id="minDisplacementValue" min="0" max="10" step="0.1" value="0.5">
                        <span class="unit-label">mm</span>
                    </div>
                    <div class="input-row">
                        <label>Sensitivity:</label>
                        <input type="number" id="sensitivityValue" min="0.1" max="5" step="0.1" value="2.0">
                        <span class="unit-label">×</span>
                    </div>
                    <div class="input-row">
                        <label>Base Resolution:</label>
                        <input type="number" id="baseResolutionValue" min="10" max="200" step="5" value="50">
                        <span class="unit-label">pts/turn</span>
                    </div>
                    <div class="input-row">
                        <label>Resolution Multiplier:</label>
                        <input type="number" id="resolutionMultiplierValue" min="1" max="10" step="0.5" value="3">
                        <span class="unit-label">×</span>
                    </div>
                    <div class="input-row">
                        <label>Darkness Threshold:</label>
                        <input type="number" id="darknessThresholdValue" min="0.01" max="1" step="0.01" value="0.1">
                        <span class="unit-label">level</span>
                    </div>
                </div>

                <div class="control-group">
                    <h3>Smooth Curves</h3>
                    <div class="input-row">
                        <label>Enable Smoothing:</label>
                        <input type="checkbox" id="enableSmoothing" checked style="width: auto;">
                    </div>
                    <div class="input-row">
                        <label>Smoothing Factor:</label>
                        <input type="number" id="smoothingFactorValue" min="0.1" max="1" step="0.1" value="0.5">
                        <span class="unit-label">strength</span>
                    </div>
                    <div class="input-row">
                        <label>Curve Segments:</label>
                        <input type="number" id="curveSegmentsValue" min="3" max="20" step="1" value="8">
                        <span class="unit-label">segments</span>
                    </div>
                </div>

                <div class="control-group">
                    <h3>Output Statistics</h3>
                    <div class="stats-display">
                        <div class="stat-item">
                            <label>Spiral Segments:</label>
                            <span id="segmentCount">0</span>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <h3>Download</h3>
                    <div class="download-buttons">
                        <button class="download-btn" id="downloadBtn" disabled>Download SVG</button>
                        <button class="download-btn" id="downloadGcodeBtn" disabled style="background: #e67e22;">Download G-code</button>
                    </div>
                </div>
            </div>

            <div class="preview-area">
                <div class="svg-stack">
                    <svg id="outputSvg" class="channel-svg" viewBox="0 0 200 200" preserveAspectRatio="xMidYMid meet">
                        <rect width="100%" height="100%" fill="white"/>
                        <g id="pen-plotter-lines" stroke="black" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        </g>
                    </svg>
                </div>
            </div>
        </div>
    </div>

    <!-- Progress indicator -->
    <div id="progressIndicator" class="progress-indicator" style="display: none;">
        <div class="spinner"></div>
        <div class="progress-text">Processing...</div>
    </div>

    <script src="script.js"></script>
</body>
</html>